# Exploitation

## Reconnaissance
Port scanning revealed an HTTP service running on port 80.
The server was identified as **nginx**.

## Parameter Discovery
The application used a GET parameter to load invoice files:

?invoice=example

## Local File Inclusion
By manipulating the parameter, arbitrary files were included:

../../../../etc/passwd

The contents of the system password file were successfully read.

## Log File Discovery
Nginx access logs were located at:

/var/log/nginx/access.log

Older logs were archived using logrotate:

access.log.1

## Log Poisoning
A PHP payload was injected into the access log via a crafted HTTP request.

When the poisoned log file was included through the LFI vulnerability,
the payload was executed by the server.

## Reverse Shell
A reverse shell payload was injected, causing the target to connect back
to the attacker:

nc -lvp 1337

The connection resulted in an interactive shell as www-data.

---

# Mitigation

To prevent LFI and log poisoning attacks:

- Never include files directly from user input
- Use allowlists for file inclusion
- Validate and normalize paths using realpath()
- Restrict permissions on log files
- Prevent logs from being interpreted as executable code
- Disable unnecessary PHP execution features
