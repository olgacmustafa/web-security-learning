# Exploitation

Bu aÅŸamada, tespit edilen Server-Side Template Injection (SSTI)
zafiyeti adÄ±m adÄ±m test edilmiÅŸtir.

AmaÃ§; kullanÄ±cÄ± girdilerinin sunucu tarafÄ±nda
template motoru tarafÄ±ndan iÅŸlendiÄŸini doÄŸrulamak,
kullanÄ±lan template motorunu belirlemek
ve bu zafiyetin olasÄ± etkilerini gÃ¶zlemlemektir.

---

## ğŸ” Reconnaissance

YapÄ±lan Ã¶n keÅŸif sonucunda hedef sistemde
aÅŸaÄŸÄ±daki servislerin Ã§alÄ±ÅŸtÄ±ÄŸÄ± tespit edilmiÅŸtir:

- HTTP servisi (Port 80)
- MySQL servisi (Port 3306)

Web uygulamasÄ±na tarayÄ±cÄ± Ã¼zerinden eriÅŸildiÄŸinde,
kullanÄ±cÄ±larÄ±n yorum girebildiÄŸi bir alan
bulunduÄŸu gÃ¶zlemlenmiÅŸtir.
Bu alan, SSTI testi iÃ§in ana saldÄ±rÄ± yÃ¼zeyi
olarak deÄŸerlendirilmiÅŸtir.

---

## ğŸ§ª SSTI Tespiti

Sunucu tarafÄ±nda template deÄŸerlendirmesi yapÄ±lÄ±p
yapÄ±lmadÄ±ÄŸÄ±nÄ± anlamak amacÄ±yla,
yorum alanÄ±na aÅŸaÄŸÄ±daki test girdisi gÃ¶nderilmiÅŸtir:

```text
{{7*7}}
```
UygulamanÄ±n bu girdiye karÅŸÄ±lÄ±k olarak
49 sonucunu dÃ¶ndÃ¼rmesi,
kullanÄ±cÄ± girdisinin sunucu tarafÄ±nda
template motoru tarafÄ±ndan iÅŸlendiÄŸini
gÃ¶stermiÅŸtir.

Bu durum, SSTI zafiyetinin varlÄ±ÄŸÄ±nÄ±
doÄŸrulamaktadÄ±r.

ğŸ§  Template Motorunun Belirlenmesi
KullanÄ±lan template motorunu belirlemek amacÄ±yla,
farklÄ± davranÄ±ÅŸlar sergileyen test ifadeleri
kullanÄ±lmÄ±ÅŸtÄ±r.

Ã–rnek test girdisi:

```text
{{7*'7'}}
```
Bu girdiye karÅŸÄ±lÄ±k olarak uygulamanÄ±n
49 sonucunu dÃ¶ndÃ¼rmesi,
kullanÄ±lan template motorunun
Twig olabileceÄŸini gÃ¶stermektedir.

(Jinja2 gibi bazÄ± motorlar bu ifadeyi
farklÄ± ÅŸekilde yorumlamaktadÄ±r.)

## âš™ï¸ Komut Ã‡alÄ±ÅŸtÄ±rmanÄ±n GÃ¶zlemlenmesi
Twig template motorunun,
gÃ¼vensiz konfigÃ¼rasyonlarda
fonksiyon filtreleri Ã¼zerinden
istismar edilebildiÄŸi bilinmektedir.

YapÄ±lan testler sonucunda,
sunucu tarafÄ±nda komut Ã§alÄ±ÅŸtÄ±rÄ±labildiÄŸi
gÃ¶zlemlenmiÅŸtir.

Bu durum, SSTI zafiyetinin yalnÄ±zca
bilgi sÄ±zdÄ±rmakla kalmayÄ±p,
daha ileri seviyede
yetkisiz komut Ã§alÄ±ÅŸtÄ±rmaya
olanak tanÄ±yabileceÄŸini
gÃ¶stermektedir.

## ğŸš Etki ve Ä°leri Senaryolar
SSTI zafiyetinin bu seviyede istismar edilmesi,
saldÄ±rganÄ±n:

Sunucu Ã¼zerinde komut Ã§alÄ±ÅŸtÄ±rmasÄ±na

Uygulama kullanÄ±cÄ± yetkileriyle iÅŸlem yapmasÄ±na

Sistem yapÄ±landÄ±rma dosyalarÄ±na eriÅŸmesine

olanak tanÄ±yabilir.

Bu lab kapsamÄ±nda,
zafiyetin etkileri kontrollÃ¼ ÅŸekilde
gÃ¶zlemlenmiÅŸ ve doÄŸrulanmÄ±ÅŸtÄ±r.

## ğŸ”“ SonuÃ§
YapÄ±lan testler sonucunda,
uygulamanÄ±n Server-Side Template Injection (SSTI)
zafiyetine aÃ§Ä±k olduÄŸu kesin olarak doÄŸrulanmÄ±ÅŸtÄ±r.

Bu zafiyet, uygun koÅŸullar altÄ±nda
uygulamanÄ±n tamamen ele geÃ§irilmesine
kadar gidebilecek
kritik gÃ¼venlik riskleri
oluÅŸturmaktadÄ±r.
